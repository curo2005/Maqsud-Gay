<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Змейка</title>
<style>
  html, body {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    background: linear-gradient(135deg, #0a1a3f, #1c2e78);
    overflow: hidden;
    font-family: "Poppins", sans-serif;
    color: white;
    touch-action: none;
  }

  #score {
    position: absolute;
    top: 10px; left: 10px;
    font-size: 24px;
    z-index: 100;
    text-shadow: 0 0 10px #000;
  }

  .snake {
    position: absolute;
    width: 20px; height: 20px;
    border-radius: 4px;
    background: linear-gradient(45deg, lime, greenyellow);
  }

  .food {
    position: absolute;
    width: 20px; height: 20px;
    border-radius: 50%;
    background-color: red;
    animation: blink 0.6s infinite alternate;
  }

  @keyframes blink {0%{transform:scale(1);}100%{transform:scale(1.3);} }
#modal {
  display: none;
  position: fixed; top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.7);
  justify-content: center; align-items: center;
  z-index: 200;
}

#modalContent {
  background: #1c2e78;
  padding: 30px;
  border-radius: 15px;
  text-align: center;
  color: white;
  box-shadow: 0 0 20px rgba(0,255,255,0.3);
}

#modalContent h2 {
  margin-bottom: 20px;
}

.modal-buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
}

.modal-buttons button,
.modal-buttons a {
  padding: 12px 25px;
  border-radius: 10px;
  font-weight: bold;
  border: none;
  cursor: pointer;
  text-decoration: none;
  color: #000;
  background: #ffa500; /* оранжевый по умолчанию */
  transition: transform 0.2s;
}

.modal-buttons button:hover,
.modal-buttons a:hover {
  transform: scale(1.1);
}

/* Индивидуальные цвета кнопок */
#continueBtn { background: lime; }
#exitBtn { background: #ff4040; color: #fff; }
#nextPage { background: deepskyblue; color: #fff; }
#restartBtn { background: orange; }

#modalContent button:hover {
  filter: brightness(1.2);
  transform: translateY(-2px);
}


  #controls {
    position: fixed; bottom: 20px; left: 50%;
    transform: translateX(-50%);
    z-index: 100;
    display: grid;
    grid-template-columns: 60px 60px 60px;
    grid-template-rows: 60px 60px;
    gap: 10px;
    justify-items: center; align-items: center;
  }

  .btn {
    width: 60px; height: 60px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    color: white; font-size: 24px;
    border: none; font-weight:bold;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
</style>
</head>
<body>
<div id="score">Очки: 0</div>
<div id="game"></div>

<!-- Модальное окно -->

<div id="modal">
  <div id="modalContent">
    <h2 id="modalTitle">Игра окончена! Ваш счёт: <span id="finalScore"></span></h2>
    <div class="modal-buttons">
      <button id="restartBtn">Заново</button>
      <button id="continueBtn" style="display:none;">Продолжить</button>
      <a id="nextPage" href="page15.html" style="display:none;">Перейти на страницу</a>
      <button id="exitBtn">Выйти</button>
    </div>
  </div>
</div>


<!-- Кнопки управления -->
<div id="controls">
  <div></div><button class="btn" id="up">↑</button><div></div>
  <button class="btn" id="left">←</button><button class="btn" id="down">↓</button><button class="btn" id="right">→</button>
</div>

<script>
const game = document.getElementById("game");
const scoreDisplay = document.getElementById("score");
const modal = document.getElementById("modal");
const finalScore = document.getElementById("finalScore");
const restartBtn = document.getElementById("restartBtn");
const continueBtn = document.getElementById("continueBtn");
const nextPage = document.getElementById("nextPage");
const exitBtn = document.getElementById("exitBtn");
const modalTitle = document.getElementById("modalTitle");

const gridSize = 20;
const cols = Math.floor(window.innerWidth / gridSize);
const rows = Math.floor(window.innerHeight / gridSize);

let snake, dx, dy, food, score, speed, gameInterval;
let reached20 = false;

function initGame() {
  snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
  dx = 1; dy = 0;
  score = 0;
  speed = 150;
  reached20 = false;
  nextPage.style.display = 'none';
  continueBtn.style.display = 'none';
  randomFood();
  draw();
  clearInterval(gameInterval);
  gameInterval = setInterval(move, speed);
}

function randomFood() {
  food = {x: Math.floor(Math.random()*cols), y: Math.floor(Math.random()*rows)};
  if(snake.some(seg => seg.x===food.x && seg.y===food.y)) randomFood();
}

function draw() {
  game.innerHTML = '';
  snake.forEach((seg, index) => {
    const s = document.createElement('div');
    s.classList.add('snake');
    s.style.left = (seg.x * gridSize) + 'px';
    s.style.top = (seg.y * gridSize) + 'px';
    s.style.background = `hsl(${(index * 15) % 360}, 100%, 50%)`;
    game.appendChild(s);
  });
  const f = document.createElement('div');
  f.classList.add('food');
  f.style.left = (food.x * gridSize) + 'px';
  f.style.top = (food.y * gridSize) + 'px';
  game.appendChild(f);
  scoreDisplay.textContent = "Очки: " + score;
}

function move() {
  const head = {x: snake[0].x + dx, y: snake[0].y + dy};

  if(head.x<0 || head.y<0 || head.x>=cols || head.y>=rows || snake.some(seg=>seg.x===head.x&&seg.y===head.y)) {
    clearInterval(gameInterval);
    finalScore.textContent = score;
    modal.style.display = 'flex';
    if(score >= 20) nextPage.style.display = 'inline-block';
    return;
  }

  snake.unshift(head);

  if(head.x===food.x && head.y===food.y) {
    score++;
    if(speed > 50) speed -= 5;
    clearInterval(gameInterval);
    gameInterval = setInterval(move, speed);
    randomFood();

   if(score === 2 && !reached20) {
  reached20 = true;
  modal.style.display = 'flex';
  continueBtn.style.display = 'inline-block';
  nextPage.style.display = 'inline-block'; // <-- добавлено
  finalScore.textContent = score;
  modalTitle.textContent = 'Поздравляем! Вы достигли 20 очков!';
  clearInterval(gameInterval);
}

  } else snake.pop();

  draw();
}

document.addEventListener('keydown', e => {
  if(e.key==="ArrowUp"&&dy===0){dx=0;dy=-1;}
  if(e.key==="ArrowDown"&&dy===0){dx=0;dy=1;}
  if(e.key==="ArrowLeft"&&dx===0){dx=-1;dy=0;}
  if(e.key==="ArrowRight"&&dx===0){dx=1;dy=0;}
});

document.getElementById('up').addEventListener('click',()=>{if(dy===0){dx=0;dy=-1;}});
document.getElementById('down').addEventListener('click',()=>{if(dy===0){dx=0;dy=1;}});
document.getElementById('left').addEventListener('click',()=>{if(dx===0){dx=-1;dy=0;}});
document.getElementById('right').addEventListener('click',()=>{if(dx===0){dx=1;dy=0;}});

restartBtn.addEventListener('click',()=>{
  modal.style.display='none';
  modalTitle.textContent='Игра окончена! Ваш счёт: ';
  continueBtn.style.display='none';
  initGame();
});

continueBtn.addEventListener('click',()=>{
  modal.style.display='none';
  continueBtn.style.display='none';
  modalTitle.textContent='Игра окончена! Ваш счёт: ';
  gameInterval = setInterval(move, speed);
});

exitBtn.addEventListener('click',()=>{
  window.location.href = "index.html"; // переход на главную страницу
});

initGame();
</script>
</body>
</html>
